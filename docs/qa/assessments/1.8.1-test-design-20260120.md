# Test Design: Story 1.8.1

Date: 2026-01-20
Designer: Quinn (Test Architect)

## Test Strategy Overview

- Total test scenarios: 8
- Unit tests: 4 (50%)
- Integration tests: 3 (37.5%)
- E2E tests: 1 (12.5%)
- Priority distribution: P0: 4, P1: 3, P2: 1

## Test Scenarios by Acceptance Criteria

### AC1: Client API & Types

| ID | Level | Priority | Test | Justification |
| :--- | :--- | :--- | :--- | :--- |
| 1.8.1-UNIT-001 | Unit | P0 | API Client returns typed data on 200 OK | Validate interface adherence |
| 1.8.1-UNIT-002 | Unit | P1 | API Client throws specific errors on 4xx/5xx | Ensure error propagation |

### AC2: Refactorisation de la Gestion d'Ã‰tat

| ID | Level | Priority | Test | Justification |
| :--- | :--- | :--- | :--- | :--- |
| 1.8.1-UNIT-003 | Unit | P0 | Reducer handles FETCH_START/SUCCESS/ERROR | Pure logic validation (critical) |
| 1.8.1-UNIT-004 | Unit | P1 | Transition from loading to success updates `questionsP1` | State integrity |

### AC3: Orchestration Phase 1

| ID | Level | Priority | Test | Justification |
| :--- | :--- | :--- | :--- | :--- |
| 1.8.1-INT-001 | Integration | P0 | QuizEngine calls `/generate` on mount | Verify early trigger |
| 1.8.1-INT-002 | Integration | P0 | QuizEngine calls `/archetype` after 6th question | Core business flow trigger |
| 1.8.1-INT-003 | Integration | P1 | Fallback to `mock-quiz.json` on API error | Mitigates TECH-001 |
| 1.8.1-E2E-001 | E2E | P2 | Full Phase 1 flow with real/mock API | Happy path smoke test |

## Risk Coverage

| Risk ID | Mitigating Test(s) |
| :--- | :--- |
| TECH-001 | 1.8.1-INT-003, 1.8.1-UNIT-003 |
| DATA-001 | 1.8.1-UNIT-001 |
| OPS-001 | 1.8.1-INT-003 |
| TECH-002 | 1.8.1-INT-001 |

## Recommended Execution Order

1. **P0 Unit tests**: Reducer logic and API Client (Vitest)
2. **P0 Integration tests**: API Orchestration in `QuizEngine` (React Testing Library with MSW)
3. **P1 tests**: Fallback logic and error propagation
4. **P2 E2E test**: Playwright smoke test
